---
title: "Further Analyss of the NYC Data"
author: "Andrea Ramirez and Karen Britt"
date: "6/23/2021"
last modified: "06/24/2021"
output: html_document
---
First we will install the required packages for visualizations
```{r}
library (readr)
library(ggplot2)
library(tidyverse)
library(scales)
library(modelr)
library(lubridate)
theme_set(theme_bw())
options(repr.plot.width=4, repr.plot.height=3)
```


Now we will install the police complaint data set
```{r}
library(readr)
complaints <- read_csv("nyc_clean.csv")

View(complaints)
```

### A Further Analyss of the NYC data. 

### Which gender has more complaints 
### NOTE there are significantly less women than men in the force 
```{r}
gender <- nyc_clean %>% 
  distinct(ComplaintID, OfficerGender) %>%
  group_by(OfficerGender) %>%
  count() %>%
  rename(num_complaints = n) 
  
gender %>%
ggplot(aes(x = OfficerGender , y = num_complaints , color = OfficerGender , fill = OfficerGender)) + geom_bar(stat = "identity")
```

### How does the total number of complaints vary throughout the 10 years (2007 - 2017)
```{r}
Complaints_with_year <- nyc_clean %>%
  distinct(ComplaintID, OfficerID, IncidentDate) %>%
  group_by(IncidentDate, OfficerID) %>%
  count() %>%
  rename(num_complaints = n) %>%
  arrange(desc(num_complaints)) %>%
  mutate(IncidentYear = year(IncidentDate))

  
Complaints_per_year <- Complaints_and_year %>%
  ungroup(OfficerID, IncidentDate) %>%
  group_by(IncidentYear) %>%
  count () %>%
  rename(Sum_complaints = n) %>%
  filter(IncidentYear == "2007" | IncidentYear == "2008" | IncidentYear == "2009" | IncidentYear == "2010" | IncidentYear == "2011" | IncidentYear == "2012" | IncidentYear == "2013" | IncidentYear == "2014" | IncidentYear == "2015" | IncidentYear == "2016" | IncidentYear == "2017")

  
Complaints_per_year %>%
ggplot(aes(x = IncidentYear , y = Sum_complaints)) + geom_line() + ylim(2000,6000)
```

### How does the number of police complaints change throughout the year?

```{r}
complaints_bydate <- complaints %>%
  distinct(IncidentDate, ComplaintID) %>%
  group_by(IncidentDate) %>%
  summarise(count = n())

View(complaints_bydate)
```
line graph of the number of complaints on the y axis and the date on the x axis (each year is a different line, months on the bottom, year is on legend )  

```{r}
#line graph of all years and complaints
ggplot(data = complaints_bydate) + 
  geom_line(mapping = aes(x = IncidentDate, y = count))
```

```{r}
# filters each year
use mutate for a year column

mutate(complains_bydate),

```  